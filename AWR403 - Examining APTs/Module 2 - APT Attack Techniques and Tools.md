# APT Attack Techniques and Tools
-> This module coveres the tactics, techniques, and procedures of APTs
1. APT Kill Chain
2. APT TTPs

## scenario
- Trucho is a tool that weaponises PDF files by injecting malicious code
- Attackers moved laterally after infecting one computer, until they gained the information they wanted

## The APT Kill Chain

| Kill Chain Phase     | Description                                                                                                     | Scenario                                                                                                                                                                                                                                         | General Trends                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------- | --------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Reconnaissance       | Gathering  information about the target that can be used to carry out an attack                                 | Attackers browsed the organization's social media pages to identify employees with access to sensitive information                                                                                                                               | Because APTs target specific organisations that align with their motivations, they typically spend extensive resources conducting reconaissance. In this phase, APTs determine both whether or not targets are of interest and how they could perform a successful attack.                                                                                                            |
| Weaponisation        | Developing and acquiring the necessary resources (tools, infrastructure, and strategies) to carry out an attack | Based on the information they had collected, the attackers formulated an attack vector with which they would target the organization. They developed Trucho, a tool used to weaponise PDF files presumably using a code injection vulnerability. | Because APTs are well funded and patient, they can develop highly sophisticated capabilities during the Weponaisation phase, often specifically tailored to the victim's enviornment. APTs wil often attempt to avoid detection and evade defenses by testing their capabilities against security solutions and employing techniques like code obfuscation and packing.               |
| Delivery             | Delivering some kind of malicious payload to the victim.                                                        | Spearphishing emails delivered Trucho to victim endpoints.                                                                                                                                                                                       | Again, due to their advanced capabilities APTs have access to sophisticated delivery mechanisms like 0-day vulnerabilities. However, APTs will leverage less sophisticated delivery methods like spearphishing in cases where such methods are equally effective.                                                                                                                     |
| Exploitation         | Exploiting vulnerabilities in the victim's systems to achieve an end effect                                     | When opened, a code injection vulnerability is exploited to execute malicious code                                                                                                                                                               | APTs have historically exploited highly complex vulnerabilities to gain access to even the most defended systems (ex: stuxnet)                                                                                                                                                                                                                                                        |
| Installation         | Installing malicious software to maintain persistence or access additional capabilities                         | Although not in chronological order, malicious code  technically had to have been "installed" onto the victim's computer before being executed.                                                                                                  | ! some limitations like this exist in the Kill Chain--not all attacks neatly follow the 8 stages, and certain, more modern attacks like lolbins and insider threats skip over stages. APTs will attempt to avoid detection during this stage using a number of techniques, for instance by "living off the land" and using legitamate system binaries instead of installing new tools |
| Command & Control    | Communicating with the compromises systems to conduct additional activities                                     | Not specified, but the attacker used some sort of C2 method to conduct hands-on activity after compromising the victim with the code injection vulnerability.                                                                                    | In order to avoid detection, APTs will often use unorthodox ways of C2, such as using commonly accessed applications like discord.                                                                                                                                                                                                                                                    |
| Lateral Movement     | Compromising additional systems using the newly gained access. Restarts the kill chain.                         | The attacker moved from the victim's computer to another host with access to sensitive files                                                                                                                                                     |                                                                                                                                                                                                                                                                                                                                                                                       |
| Actions on Objective | Carrying out actions to achieve the specific end-goals of the intrusion.                                        | The attacker first locked the victims out of their systems, then after moving laterally to a host with higher permissions, exfiltrated sensitive data                                                                                            | Although APTs range in the objectives they want to achieve, one element unites their approach to the last stage of the kill chain: patience. Whether it be exfiltrating sensitive information, tampering with documents, or conducting a destructive attack, APTs will either spread this stage over a long period of time, or wait extensively for the right moment to strike.       |
- Each step in the kill chain is an opportunity to stop the attack
- Its best to think of an attack as a continuum, not a single incident
- effective defenses must "begin before the attack, be strong during the attack, and stay after the attack is complete"

## common techniques and tools
- Information gathered from **OSINT** Tools is extremely valuable all throughout the attack--finding an initial access vector, being aware of  defenses, knowing high priority targets to pivot to 
- **Social Engineering**--various techniques like phishing, malicious advertisements, "reverse" social engineering, etc
	- spearphishing - phishing attacks customised to a specific recipient, often using information gathered through OSINT to make the email more convincing
	- watering hole - targeting a website that victims frequently visit, in order to then target victims with attacks like drive by compromises or social enginnering
- **Malware**
	- **Rootkits** - malware designed to gain unauthorized, privileged access
	- **Worms** - malware that aims to automatically propagate to connected hosts
	- **Spyware** - malware designed to extract sensitive information
	- **Crimeware** - malware used to automate crime (ex: identity theft), umbrella term for a lot of other malware?
	- **Adware** (probably not an APT's first choice of malware) - malware that presents unwanted ads
	- **Viruses** - malware that will self-replicate with user interaction, copying itself to other files
	- **Trojans** - malware that disguises as legitamate software
- **0-days**
- **RCE** (Remote Code Execution) - a particularly critical vulnerability that allows remote, arbitrary code execution
- **n-day** / known vulnerabilities
- **Remote Access Trojans** - a Trojan containing shellcode
- **Cryptographic attacks** - exploiting weaknesses in the cryptographic scheme, implementation, or key management
